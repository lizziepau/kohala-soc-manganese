library(ggplot2)
library(ggpubr)
library(tidyverse)
library(broom)
library(AICcmodavg)

tx.time.sm <- c(time.sm.0,time.sm.0.5,time.sm.24,time.sm.72,time.sm.120)
sm<-c(sm.0,sm.0.5,sm.24,sm.72,sm.120)
df.sm <- data.frame(sm,tx.time.sm)
print(df.sm)

smglm <- glm(sm ~ tx.time.sm)
summary(smglm)         

#ANOVA
aov.sm <- aov(sm~tx.time.sm, data=df.sm)
summary(aov.sm)

#Tukey's pot-hoc test (#Tukey's requires categories as factors)
aov.factor.sm = aov(sm ~ factor(tx.time.sm), data = df.sm)
tukey.sm<-TukeyHSD(aov.factor.sm)
tukey.sm

tukey.cld.sm <- multcompLetters4(aov.factor.sm, tukey.sm)
print(tukey.cld.sm)

kw.sm<-kruskal.test(sm~tx.time.sm, data=df.sm)
kw.sm
dunn.bon.sm<-dunnTest(sm~tx.time.sm, data=df.sm, method="bonferroni")
dunn.bon.sm


#Time 0: H0-C0
sm.0 <- c(0.655894451601439,0.65571477712802,0.655901644806255,0.655738716443418,0.655959207705211,0.655841716074879,0.656012000666704,0.655964005999,0.655932820900164,0.655940016662039,0.65598800066663,0.655966405225854,0.656009600426685,0.655932820900164,0.656,0.655834526862739,0.660758526481792,0.661799242634565,0.662994057206331,0.655889656397841,0.663738074877001,0.664158486207969,0.664695033885123,0.662861141657502)
tx.time.sm.0 <- c(rep("c0",8), rep("m0",8), rep("h0",8))
df.sm.0 <- data.frame(sm.0,time.sm.0)
print(df.sm.0)
csm0<-c(0.655894451601439,0.65571477712802,0.655901644806255,0.655738716443418,0.655959207705211,0.655841716074879,0.656012000666704,0.655964005999)
msm0<-c(0.655932820900164,0.655940016662039,0.65598800066663,0.655966405225854,0.656009600426685,0.655932820900164,0.656,0.655834526862739)
hsm0<-c(0.660758526481792,0.661799242634565,0.662994057206331,0.655889656397841,0.663738074877001,0.664158486207969,0.664695033885123,0.662861141657502)
shapiro.test(csm0)#normal
shapiro.test(msm0)#normal
shapiro.test(hsm0)#not normal

kw.sm.0<-kruskal.test(sm.0~time.sm.0, data=df.sm.0)
kw.sm.0
db.sm.0<-dunnTest(sm.0~tx.time.sm.0, data=df.sm.0, method="bonferroni")
db.sm.0

aov.sm.0 <- aov(sm.0~time.sm.0, data=df.sm.0)
summary(aov.sm.0)

aov.factor.0 = aov(sm.0 ~ factor(time.sm.0), data = df.sm.0)
tukey.0<-TukeyHSD(aov.factor.0)
tukey.0

#Time 0.5: H0.5 significantly different
sm.0.5 <- c(0.643329166058498,0.643851605734006,0.636043262831059,0.654039570303387,0.655122243687962,0.655355964220234,0.655532077987002,0.654541253832141,0.65440444321022,0.654404088661741,0.655561580514689,0.65575687563869,0.655584,0.655482796522666,0.66039070222005,0.661303512532065,0.662530186059427,0.663466198731689,0.663918624794564,0.664535051660926,0.662621213635909)
tx.time.sm.0.5 <- c(rep("c0.5",7), rep("m0.5",7), rep("h0.5",7))
df.sm.0.5 <- data.frame(sm.0.5,time.sm.0.5)
print(df.sm.0.5)
csm0.5<-c(0.643329166058498,0.643851605734006,0.636043262831059,0.654039570303387,0.655122243687962,0.655355964220234,0.655532077987002)
msm0.5<-c(0.654541253832141,0.65440444321022,0.654404088661741,0.655561580514689,0.65575687563869,0.655584,0.655482796522666)
hsm0.5<-c(0.66039070222005,0.661303512532065,0.662530186059427,0.663466198731689,0.663918624794564,0.664535051660926,0.662621213635909)
shapiro.test(csm0.5)#normal
shapiro.test(msm0.5)#not normal
shapiro.test(hsm0.5)#normal

kw.sm.0.5<-kruskal.test(sm.0.5~tx.time.sm.0.5, data=df.sm.0.5)
kw.sm.0.5
db.sm.0.5<-dunnTest(sm.0.5~tx.time.sm.0.5, data=df.sm.0.5, method="bonferroni")
db.sm.0.5

aov.sm.0.5 <- aov(sm.0.5~time.sm.0.5, data=df.sm.0.5)
summary(aov.sm.0.5)

aov.factor.0.5 = aov(sm.0.5 ~ factor(time.sm.0.5), data = df.sm.0.5)
tukey.0.5<-TukeyHSD(aov.factor.0.5)
tukey.0.5

#Time 24: no significant differences
sm.24 <- c(0.631015186226416,0.622184254786925,0.627902971186142,0.632594763839851,0.638779043280182,0.642526245625728,0.652573865908384,0.629099472368787,0.626837620132215,0.637330608255209,0.6324,0.636249542017787,0.644670213120397,0.61369743139846,0.643639433490697,0.646136898680763,0.64885679368959,0.644226731980405)
tx.time.sm.24 <- c(rep("c24",6), rep("m24",6), rep("h24",6))
df.sm.24 <- data.frame(sm.24,time.sm.24)
print(df.sm.24)
csm24<-c(0.631015186226416,0.622184254786925,0.627902971186142,0.632594763839851,0.638779043280182,0.642526245625728)
msm24<-c(0.652573865908384,0.629099472368787,0.626837620132215,0.637330608255209,0.6324,0.636249542017787)
hsm24<-c(0.644670213120397,0.61369743139846,0.643639433490697,0.646136898680763,0.64885679368959,0.644226731980405)
shapiro.test(csm24)#normal
shapiro.test(msm24)#normal
shapiro.test(hsm24)#not normal

kw.sm.24<-kruskal.test(sm.24~tx.time.sm.24, data=df.sm.24)#p=0.1824
kw.sm.24
db.sm.24<-dunnTest(sm.24~tx.time.sm.24, data=df.sm.24, method="bonferroni")
db.sm.24

aov.sm.24 <- aov(sm.24~time.sm.24, data=df.sm.24)
summary(aov.sm.24)

aov.factor.24 = aov(sm.24 ~ factor(time.sm.24), data = df.sm.24)
tukey.24<-TukeyHSD(aov.factor.24)
tukey.24

#Time 72: no significant differences
sm.72 <- c(0.441076045361949,0.414203251890754,0.404660670456474,0.393437413189622,0.412356607232128,0.375204158706181,0.340939516800888,0.331878006777401,0.351328,0.385657662458782,0.346956454138578,0.317762551499738,0.347465703971118,0.400580379957782,0.442639208237529)
time.sm.72 <- c(rep("c72",5), rep("m72",5), rep("h72",5))
df.sm.72 <- data.frame(sm.72,time.sm.72)
print(df.sm.72)
csm72<-c(0.441076045361949,0.414203251890754,0.404660670456474,0.393437413189622,0.412356607232128)
msm72<-c(0.375204158706181,0.340939516800888,0.331878006777401,0.351328,0.385657662458782)
hsm72<-c(0.346956454138578,0.317762551499738,0.347465703971118,0.400580379957782,0.442639208237529)
shapiro.test(csm72)#normal
shapiro.test(msm72)#normal
shapiro.test(hsm72)#normal

kruskal.test(sm.72~time.sm.72, data=df.sm.72)#p=0.05448

aov.sm.72 <- aov(sm.72~time.sm.72, data=df.sm.72)
summary(aov.sm.72)

aov.factor.72 = aov(sm.72 ~ factor(time.sm.72), data = df.sm.72)
tukey.72<-TukeyHSD(aov.factor.72)
tukey.72

#Time 120: no significant differences
sm.120 <- c(0.265242008668778,0.225093297275191,0.206766822098504,0.207814697550408,0.163446039010086,0.122584171063594,0.111314260318871,0.181765979415782,0.132067123485445,0.107397083809925,0.133461149680643,0.25775067479756)
time.sm.120 <- c(rep("c120",4), rep("m120",4), rep("h120",4))
df.sm.120 <- data.frame(sm.120,time.sm.120)
print(df.sm.120)
csm120<-c(0.265242008668778,0.225093297275191,0.206766822098504,0.207814697550408)
msm120<-c(0.163446039010086,0.122584171063594,0.111314260318871,0.181765979415782)
hsm120<-c(0.132067123485445,0.107397083809925,0.133461149680643,0.25775067479756)
shapiro.test(csm120)#normal
shapiro.test(msm120)#normal
shapiro.test(hsm120)#normal

kruskal.test(sm.120~time.sm.120, data=df.sm.120)#p=0.8368

aov.sm.120 <- aov(sm.120~time.sm.120, data=df.sm.120)
summary(aov.sm.120)

aov.factor.120 = aov(sm.120 ~ factor(time.sm.120), data = df.sm.120)
tukey.120<-TukeyHSD(aov.factor.120)
tukey.120
